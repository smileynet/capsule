# Test Specification: Implement browse history toggle

## Bead: cap-fj8.2.3

## Tracer
View layer — proves history toggle works in the TUI.

## Context
- Extend browse.go with history toggle on 'h' key
- Extend BeadLister interface with Closed() method
- Add History key binding to keys.go

## Test Cases

| Input | Expected Output | Notes |
|-------|-----------------|-------|
| Press 'h' in browse mode (ready view) | Switch to closed beads display | Toggle on |
| Press 'h' in browse mode (history view) | Switch back to ready beads | Toggle off |
| Closed beads in list | Rendered with muted style + "[closed]" tag | Visual distinction |
| Ready beads in list | Normal rendering (unchanged) | No regression |
| Help bar in ready view | Shows "h: history" | Discoverable |
| Help bar in history view | Shows "h: ready" | Discoverable |
| Select closed bead + enter | Should not dispatch pipeline | Read-only in history |
| Browse key 'h' | Part of BrowseKeyMap bindings | Key registered |

## Edge Cases
- [ ] Toggle when no closed beads exist (show empty state)
- [ ] Toggle rapidly (no double-fetch)
- [ ] Cursor position resets to 0 on toggle
- [ ] Closed bead without type field (display gracefully)

## Implementation Notes
- browseState gains: showClosed bool, closedBeads []BeadSummary
- On 'h': if !showClosed → fetch via lister.Closed(50), set showClosed=true
- On 'h' again: set showClosed=false, display readyBeads
- BeadLister interface needs Closed(limit int) ([]BeadSummary, error)
