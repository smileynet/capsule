# TDD Spec: Validate test-writer/test-review pair end-to-end

**Task:** t-1.3.5
**Feature:** Test-writer and test-review prompt pair
**Epic:** Epic 1 - Shell-based Pipeline Prototype

## Context

Integration test that validates the full test-writer and test-review phase pair: setup template project, run prep to create worktree, run test-writer phase, verify test files created and worklog updated, run test-review phase, verify review outcome and worklog updated, then test retry flow with feedback injection.

## Test Cases

| # | Input / Setup | Expected Output | Notes |
|---|--------------|-----------------|-------|
| 1 | Setup template + prep + run test-writer | Test files created in worktree, worklog has test-writer entry | Full chain through test-writer |
| 2 | After test-writer, run test-review | Signal is PASS or NEEDS_WORK, worklog has test-review entry | Review evaluates test-writer output |
| 3 | Simulate NEEDS_WORK from test-review, retry test-writer with feedback | test-writer receives feedback, produces updated tests | Retry loop validation |
| 4 | Verify tests fail (RED) after test-writer | `go test` returns non-zero (tests fail as expected) | TDD: tests must fail before implementation |
| 5 | Verify worklog entries are chronologically ordered | Phase entries appear in execution order | Worklog is append-only |

## Edge Cases

- [ ] Test-writer creates tests in unexpected locations -- test-review should catch this
- [ ] Test-review PASS on first attempt (no retry needed) -- pipeline proceeds
- [ ] Multiple retry cycles (test-review returns NEEDS_WORK repeatedly) -- eventually succeeds or hits max retries
- [ ] Cleanup: worktree and temp files removed after test completes

## Deliverable

tests/test-phase-pair-test-writer.sh
