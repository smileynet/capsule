# TDD Spec: Create run-pipeline.sh orchestration script

**Task:** t-1.6.1
**Feature:** Full pipeline orchestration
**Epic:** Epic 1 - Shell-based Pipeline Prototype

## Context

scripts/run-pipeline.sh orchestrates the full pipeline: prep, test-writer/test-review loop, execute/execute-review loop, sign-off, merge. Implements retry logic for NEEDS_WORK signals with configurable max retries. Aborts on ERROR signals. Prints summary at completion.

## Test Cases

| # | Input / Setup | Expected Output | Notes |
|---|--------------|-----------------|-------|
| 1 | Mock run-phase.sh returning all PASS | Pipeline completes, all phases run in order, exit 0 | Happy path, no retries |
| 2 | Mock test-review returning NEEDS_WORK once then PASS | test-writer retried with feedback, then proceeds | Single retry |
| 3 | Mock test-review returning NEEDS_WORK beyond max retries | Pipeline aborts with retry exhaustion error | Max retry enforcement |
| 4 | Mock execute returning ERROR | Pipeline aborts immediately with error details | ERROR = immediate abort |
| 5 | Verify summary output | Prints phase results, durations, retry counts | Operator visibility |
| 6 | Run with bead-id argument | Pipeline runs prep with that bead-id, passes worktree to phases | End-to-end argument threading |

## Edge Cases

- [ ] Pipeline interrupted with SIGINT -- cleanup runs (worktree preserved or cleaned based on policy)
- [ ] run-phase.sh itself crashes (non-signal failure) -- treated as ERROR
- [ ] Retry feedback from review is correctly passed to the next writer/execute invocation
- [ ] Max retries configurable via environment variable or flag

## Deliverable

scripts/run-pipeline.sh
