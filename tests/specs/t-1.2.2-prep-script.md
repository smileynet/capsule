# TDD Spec: Create prep.sh script for worktree + worklog setup

**Task:** t-1.2.2
**Feature:** Worktree creation and worklog instantiation
**Epic:** Epic 1 - Shell-based Pipeline Prototype

## Context

scripts/prep.sh takes a bead-id argument: validates the bead exists and is ready, extracts bead context (epic, feature, task metadata), creates a git worktree on a new branch, instantiates the worklog template with bead data, and places the worklog in the worktree root.

## Test Cases

| # | Input / Setup | Expected Output | Notes |
|---|--------------|-----------------|-------|
| 1 | Run prep.sh with valid bead-id on setup template project | Worktree created, worklog.md present in worktree | Happy path |
| 2 | Verify worktree branch name | Branch name contains or derives from bead-id | Predictable branch naming |
| 3 | Verify worklog.md content in worktree | All bead metadata interpolated correctly | Cross-check against bd show output |
| 4 | Run prep.sh with invalid/nonexistent bead-id | Non-zero exit code, error message | Validation before any side effects |
| 5 | Run prep.sh when worktree already exists for bead | Error or idempotent skip with message | Prevents duplicate worktrees |
| 6 | Verify worktree is on a separate branch from main | `git branch` in worktree shows non-main branch | Isolation from main branch |

## Edge Cases

- [ ] Bead-id with special characters handled safely in branch names
- [ ] Script works when main branch has uncommitted changes (worktree should be clean)
- [ ] worklog.md is not git-committed yet (left for pipeline phases to manage)
- [ ] Script fails gracefully if git worktree add fails (e.g., disk full)

## Deliverable

scripts/prep.sh
