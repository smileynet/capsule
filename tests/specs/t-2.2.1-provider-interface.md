# TDD Spec: Define Provider interface, Result, and Signal types

**Task:** t-2.2.1
**Feature:** Provider interface
**Epic:** Epic 2 - Go CLI Tool

## Context

Define the Provider interface that all AI providers must implement, along with Result, Signal, and PhaseResult types. Create a MockProvider for testing. Implement SignalParser to extract structured signals from provider output. Define typed errors (ErrNoSignal, ErrMalformedSignal, etc.).

## Test Cases

| # | Input / Setup | Expected Output | Notes |
|---|--------------|-----------------|-------|
| 1 | MockProvider.Execute returns configured Result | Result matches configured values | Mock contract |
| 2 | Parse valid signal JSON from output string | Signal with correct status, feedback, files_changed, summary | Happy path parsing |
| 3 | Parse output with no JSON signal | ErrNoSignal error returned | Missing signal detection |
| 4 | Parse output with malformed JSON | ErrMalformedSignal error returned | Invalid JSON handling |
| 5 | Verify errors.Is works with signal errors | errors.Is(err, ErrNoSignal) returns true | Typed error semantics |
| 6 | Parse signal from mixed output (text + JSON) | Last JSON block extracted as signal | Real-world claude output |

## Edge Cases

- [ ] Signal JSON embedded in markdown code fences
- [ ] Multiple JSON blocks in output -- last one is the signal
- [ ] Signal with unknown status value maps to appropriate error or default
- [ ] Empty output string returns ErrNoSignal

## Deliverable

Provider interface with signal parsing
