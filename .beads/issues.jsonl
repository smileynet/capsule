{"id":"cap-10s","title":"Multi-CLI Support","description":"Support multiple AI CLI tools beyond Claude Code. Provider interface extensions for OpenCode, Kiro, and other headless CLI tools with provider-specific prompt adaptation.","acceptance_criteria":"capsule run --provider=opencode executes pipeline with OpenCode CLI","status":"open","priority":4,"issue_type":"epic","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:11.111436636-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:11.111436636-08:00","dependencies":[{"issue_id":"cap-10s","depends_on_id":"cap-6vp","type":"blocks","created_at":"2026-02-06T08:28:17.573861833-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-10s.1","title":"Provider interface extensions for multi-CLI","description":"As a user, I want to use capsule with different AI CLI tools so that I'm not locked into one provider. (Placeholder — TBD during Epic 5 scoping)","acceptance_criteria":"TBD during Epic 5 scoping","status":"open","priority":4,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:35.216376541-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:35.216376541-08:00","dependencies":[{"issue_id":"cap-10s.1","depends_on_id":"cap-10s","type":"parent-child","created_at":"2026-02-06T08:29:35.218133867-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-10s.2","title":"Provider-specific prompt adaptation","description":"As a user, I want prompts that adapt to each provider's capabilities so that the pipeline works well regardless of provider. (Placeholder — TBD during Epic 5 scoping)","acceptance_criteria":"TBD during Epic 5 scoping","status":"open","priority":4,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:35.275086945-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:35.275086945-08:00","dependencies":[{"issue_id":"cap-10s.2","depends_on_id":"cap-10s","type":"parent-child","created_at":"2026-02-06T08:29:35.276788648-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-6ih","title":"Add Given-When-Then comments to shell test scripts","description":"Discovery Source: cap-8ax.2 - Worktree creation and worklog instantiation\nDiscovered During: plate/maître review\n\nImpact:\nBDD traceability from .feature files to test implementations. Currently a project-wide gap (f-1.1 and f-1.2 tests both lack GWT comments).\n\nContext:\nAdd # Given:, # When:, # Then: comments to each test block in all test scripts under tests/scripts/. This maps feature scenarios to test implementations for maintainability.","status":"open","priority":3,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T20:43:55.700101106-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T20:43:55.700101106-08:00"}
{"id":"cap-6vp","title":"Robust Task Pipeline","description":"More granular pipeline steps and commands. Configurable phase definitions, pluggable quality gates, advanced retry strategies, parallel phase execution, and pipeline pause/resume.","acceptance_criteria":"Custom phase definitions loaded from project config; Pipeline pause/resume preserves state across sessions","status":"open","priority":3,"issue_type":"epic","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:07.949184454-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:07.949184454-08:00","dependencies":[{"issue_id":"cap-6vp","depends_on_id":"cap-awd","type":"blocks","created_at":"2026-02-06T08:28:17.520884744-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-6vp.1","title":"Configurable phase definitions","description":"As a user, I want to define custom phase pairs so that the pipeline adapts to my workflow. (Placeholder — TBD during Epic 4 scoping)","acceptance_criteria":"TBD during Epic 4 scoping","status":"open","priority":3,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:35.047547633-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:35.047547633-08:00","dependencies":[{"issue_id":"cap-6vp.1","depends_on_id":"cap-6vp","type":"parent-child","created_at":"2026-02-06T08:29:35.049096867-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-6vp.2","title":"Pipeline pause and resume","description":"As a user, I want to pause and resume a pipeline so that long missions survive session interruptions. (Placeholder — TBD during Epic 4 scoping)","acceptance_criteria":"TBD during Epic 4 scoping","status":"open","priority":3,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:35.103729975-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:35.103729975-08:00","dependencies":[{"issue_id":"cap-6vp.2","depends_on_id":"cap-6vp","type":"parent-child","created_at":"2026-02-06T08:29:35.105575947-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-6vp.3","title":"Advanced retry strategies","description":"As a user, I want configurable retry strategies (backoff, skip, escalate) so that the pipeline handles failures intelligently. (Placeholder — TBD during Epic 4 scoping)","acceptance_criteria":"TBD during Epic 4 scoping","status":"open","priority":3,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:35.158889942-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:35.158889942-08:00","dependencies":[{"issue_id":"cap-6vp.3","depends_on_id":"cap-6vp","type":"parent-child","created_at":"2026-02-06T08:29:35.160683718-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-7y0","title":"Create smoke tests for user-facing scripts","description":"Discovery Source: cap-8ax.2 - Worktree creation and worklog instantiation\nDiscovered During: plate/maître review\n\nImpact:\nFast critical-path checks for prep.sh and setup-template.sh. Smoke tests are minimal happy-path validation suitable as pipeline gates.\n\nContext:\nCreate tests/scripts/smoke-prep.sh (and smoke-setup.sh) that exercise the happy path end-to-end in a single pass: create project, run prep, verify worktree + worklog + branch exist, exit. Target under 10 seconds.","status":"open","priority":3,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T20:43:58.575071231-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T20:43:58.575071231-08:00"}
{"id":"cap-8ax","title":"Tracer Bullet: Scripts \u0026 Direct Claude CLI","description":"Prove the headless claude workflow end-to-end using shell scripts, template beads, and direct claude -p invocations. No Go code. Output: working scripts, captured commands, proven prompt pairs.","acceptance_criteria":"Full pipeline runs on template project without manual intervention; Tests are created, implementation passes all tests; Only implementation files merged to main; Worklog archived to .capsule/logs/; Pipeline is idempotent","status":"open","priority":0,"issue_type":"epic","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:27:59.21201792-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:27:59.21201792-08:00"}
{"id":"cap-8ax.1","title":"Reusable template project with bead fixtures","description":"As a capsule developer, I want a template project with pre-built beads so that I can repeatedly test the pipeline against a known starting state.","acceptance_criteria":"Given a clean directory, When setup-template.sh runs, Then a git repo exists with source files, CLAUDE.md, and .beads/ initialized; Given the template repo, When bd ready runs, Then at least one task bead is available to work; Given the template beads, When bd show \u003ctask-id\u003e runs, Then the bead has title, description, acceptance criteria, and parent feature/epic; Given multiple test runs, When setup-template.sh runs each time, Then the starting state is identical (deterministic)","status":"closed","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:48.583827856-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T18:22:00.651915291-08:00","closed_at":"2026-02-06T18:22:00.651915291-08:00","close_reason":"All 3 children completed. BDD acceptance criteria validated: setup script creates git repo with template files and beads, bd ready/show work, deterministic state confirmed.","dependencies":[{"issue_id":"cap-8ax.1","depends_on_id":"cap-8ax","type":"parent-child","created_at":"2026-02-06T08:28:48.58559356-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.1.1","title":"Create template project source files and CLAUDE.md","description":"Create templates/demo-capsule/ with: src/ with a simple Go module (main.go, go.mod) that has a clear feature gap for the test bead to fill, CLAUDE.md documenting the project structure and conventions, README.md with project description. Tests: validate files exist, go build succeeds on template. Deliverable: templates/demo-capsule/ with buildable Go project","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:51.277874165-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T16:47:04.01557824-08:00","closed_at":"2026-02-06T16:47:04.01557824-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.1.1","depends_on_id":"cap-8ax.1","type":"parent-child","created_at":"2026-02-06T08:29:51.279600593-08:00","created_by":"Sam Biggins"}],"comments":[{"id":1,"issue_id":"cap-8ax.1.1","author":"Sam Biggins","text":"PHASE: COOK\nStatus: started","created_at":"2026-02-07T00:42:59Z"},{"id":2,"issue_id":"cap-8ax.1.1","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create the reusable template project that serves as the test subject for pipeline E2E testing\nBefore: No template project existed; pipeline had nothing to operate on\nAfter: templates/demo-capsule/ contains a buildable Go project with Contact type, FEATURE_GAP markers for validation functions, CLAUDE.md, and README.md\n\nFiles: 5 changed (go.mod, main.go, CLAUDE.md, README.md, test script)\nFindings: none","created_at":"2026-02-07T00:47:12Z"},{"id":3,"issue_id":"cap-8ax.1.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 found (3 nits, no action needed)\nSummary: Clean implementation aligned with TDD spec. All 6 test cases + 4 edge cases covered. Feature gap design well-suited for sibling task.","created_at":"2026-02-07T00:48:53Z"},{"id":4,"issue_id":"cap-8ax.1.1","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create template project as reusable test subject for pipeline E2E testing\nBefore: No template project; pipeline had nothing to operate on\nAfter: templates/demo-capsule/ with buildable Go module, FEATURE_GAP markers, and full docs\n\nProblems encountered:\n  - Arithmetic under set -e in test script: fixed by using PASS=$((PASS + 1)) syntax\n  - go build left binary artifact: fixed by building to temp dir\n\nIssues filed: 0\nCommit: a71c192\nPush: skipped (no remote)","created_at":"2026-02-07T00:49:43Z"}]}
{"id":"cap-8ax.1.2","title":"Create template bead fixtures (JSONL)","description":"Create templates/demo-capsule/issues.jsonl with hierarchy: 1 epic: Demo Capsule Feature Set, 1 feature: Add input validation (under epic), 2 tasks: Validate email format, Validate phone format (under feature, with acceptance criteria in descriptions). Each bead has: id, title, description with acceptance criteria, type, priority, dependencies. Tests: JSONL parses correctly, bd import succeeds, hierarchy valid. Deliverable: issues.jsonl with 4 beads in epic→feature→task hierarchy","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:51.335308489-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T16:59:00.519602127-08:00","closed_at":"2026-02-06T16:59:00.519602127-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.1.2","depends_on_id":"cap-8ax.1","type":"parent-child","created_at":"2026-02-06T08:29:51.337510633-08:00","created_by":"Sam Biggins"}],"comments":[{"id":5,"issue_id":"cap-8ax.1.2","author":"Sam Biggins","text":"PHASE: COOK\nStatus: started","created_at":"2026-02-07T00:55:47Z"},{"id":6,"issue_id":"cap-8ax.1.2","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create template bead fixtures so the pipeline has a known starting state to test against\nBefore: Template project had source files but no beads to define work items\nAfter: issues.jsonl with 4 beads (epic→feature→2 tasks) ready for bd import, with acceptance criteria in task descriptions\n\nFiles: 2 changed (issues.jsonl, test-fixtures.sh)\nFindings: none","created_at":"2026-02-07T00:59:08Z"},{"id":7,"issue_id":"cap-8ax.1.2","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 critical/major, 3 minor (1 auto-fixed), 3 nits (deferred)\nSummary: Well-structured JSONL fixtures with correct hierarchy and thorough test coverage. Fixed git config for CI portability. Minor nits (test numbering, helper order) deferred as cosmetic.","created_at":"2026-02-07T01:01:06Z"},{"id":8,"issue_id":"cap-8ax.1.2","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create template bead fixtures so the pipeline has a known starting state to test against\nBefore: Template project had source files but no beads to define work items\nAfter: issues.jsonl with 4 beads (epic→feature→2 tasks) ready for bd import\n\nProblems encountered:\n  - Positional jq indexing: fixed to id-based lookups after taster review\n  - Subshell counter bug: fixed by avoiding subshell for verification block\n\nIssues filed: 0\nCommit: a477f1e\nPush: success","created_at":"2026-02-07T01:56:35Z"}]}
{"id":"cap-8ax.1.3","title":"Create setup-template.sh initialization script","description":"Script that creates a fresh test environment: 1. Create temp dir (or accept target dir arg), 2. git init, initial commit, 3. Copy template source files, 4. bd init --prefix=cap, 5. bd import -i issues.jsonl, 6. bd dep add (wire dependencies), 7. git add \u0026\u0026 git commit. Error handling: fail fast with clear messages on any step failure. Tests: run script, verify git log, verify bd ready output. Depends on: t-1.1.1, t-1.1.2. Deliverable: scripts/setup-template.sh that creates deterministic test environment","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:51.397919411-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T18:14:52.143225694-08:00","closed_at":"2026-02-06T18:14:52.143225694-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.1.3","depends_on_id":"cap-8ax.1","type":"parent-child","created_at":"2026-02-06T08:29:51.399566544-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.1.3","depends_on_id":"cap-8ax.1.1","type":"blocks","created_at":"2026-02-06T08:32:04.892770486-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.1.3","depends_on_id":"cap-8ax.1.2","type":"blocks","created_at":"2026-02-06T08:32:04.958234567-08:00","created_by":"Sam Biggins"}],"comments":[{"id":9,"issue_id":"cap-8ax.1.3","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create setup-template.sh that produces a deterministic test environment from the demo-capsule template\nBefore: Template files and bead fixtures existed but no automation to create a fresh project from them\nAfter: scripts/setup-template.sh creates a git repo with template files and imported beads; bd ready lists 2 task beads\n\nFiles: 2 changed (1 new script, 1 new test)\nFindings: Pre-existing E4 failure in test-template-source-files.sh (test-fixtures.sh references /tmp/) — not related to this task","created_at":"2026-02-07T02:15:00Z"},{"id":10,"issue_id":"cap-8ax.1.3","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved (after fixes)\nIssues: 0 critical, 1 major (fixed), 2 minor (fixed), 2 nits (deferred)\nSummary: Well-structured scripts following codebase patterns. Fixed temp dir cleanup leak, PATH regex safety, and pre-existing git repo guard. All tests pass.","created_at":"2026-02-07T02:17:30Z"},{"id":11,"issue_id":"cap-8ax.1.3","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create setup-template.sh that produces a deterministic test environment from the demo-capsule template\nBefore: Template files and bead fixtures existed but no automation to assemble them into a working project\nAfter: scripts/setup-template.sh creates git repo with template files and imported beads; bd ready lists 2 task beads\n\nProblems encountered:\n  - bd init writes to stdout: fixed by redirecting to /dev/null\n  - Taster: fragile FAKE_PATH approach: replaced with PATH filtering\n  - Sous-chef: temp dir cleanup leak: fixed with array-based trap\n\nIssues filed:\n  - cap-lbj: Fix hardcoded /tmp/ reference in test-fixtures.sh [P4]\n\nCommit: bb79431\nPush: success","created_at":"2026-02-07T02:18:39Z"}]}
{"id":"cap-8ax.2","title":"Worktree creation and worklog instantiation from bead template","description":"As a pipeline orchestrator, I want a prep script that creates an isolated worktree and instantiates a worklog from the bead context so that each phase has full context and a shared log.","acceptance_criteria":"Given a template project with beads, When prep.sh \u003cbead-id\u003e runs, Then a git worktree exists at .capsule/worktrees/\u003cbead-id\u003e/; Given the worktree, When cat worklog.md runs, Then the worklog contains Mission Briefing with epic/feature/task context and acceptance criteria; Given the worktree, When git branch runs, Then the branch is named capsule-\u003cbead-id\u003e; Given the worklog template, When instantiated for different beads, Then each worklog has bead-specific content (not generic)","status":"closed","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:48.639383289-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T20:44:03.975328985-08:00","closed_at":"2026-02-06T20:44:03.975328985-08:00","close_reason":"All children complete (cap-8ax.2.1 + cap-8ax.2.2). Feature delivers prep.sh with worktree creation and worklog instantiation. 28 tests passing.","dependencies":[{"issue_id":"cap-8ax.2","depends_on_id":"cap-8ax","type":"parent-child","created_at":"2026-02-06T08:28:48.641030149-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.2.1","title":"Create worklog.md template with bead interpolation","description":"Create templates/worklog.md.template with placeholders: {{EPIC_ID}}, {{EPIC_TITLE}}, {{EPIC_GOAL}}, {{FEATURE_ID}}, {{FEATURE_TITLE}}, {{FEATURE_GOAL}}, {{TASK_ID}}, {{TASK_TITLE}}, {{TASK_DESCRIPTION}}, {{ACCEPTANCE_CRITERIA}} (bulleted list), {{TIMESTAMP}}. Structure follows legacy worklog: Mission Briefing → Phase entries. Tests: template renders with sample data, all placeholders replaced. Deliverable: templates/worklog.md.template","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:59.65163291-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T18:34:20.176315025-08:00","closed_at":"2026-02-06T18:34:20.176315025-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.2.1","depends_on_id":"cap-8ax.2","type":"parent-child","created_at":"2026-02-06T08:29:59.704284141-08:00","created_by":"Sam Biggins"}],"comments":[{"id":12,"issue_id":"cap-8ax.2.1","author":"Sam Biggins","text":"PHASE: COOK\nStatus: started","created_at":"2026-02-07T02:27:27Z"},{"id":13,"issue_id":"cap-8ax.2.1","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create worklog template with bead interpolation for pipeline context\nBefore: No worklog template existed; pipeline phases had no shared context document\nAfter: templates/worklog.md.template provides Mission Briefing + Phase Log structure with 11 placeholders; test script validates rendering including special chars and multi-line criteria\n\nFiles: 2 changed (1 new template, 1 new test script)\nFindings: envsubst is the correct rendering approach for this template (bash parameter expansion mangles \u0026 characters); prep.sh (cap-8ax.2.2) should use the same envsubst pattern","created_at":"2026-02-07T02:34:24Z"},{"id":14,"issue_id":"cap-8ax.2.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 0 critical/major/minor, 3 nits (deferred)\nSummary: Well-structured template and thorough test script. envsubst approach is correct and safe. Nits: Test 1 only checks 6/11 placeholders (others caught by Test 5), results footer format pre-existing inconsistency, FEATURE_GOAL not in spec but correctly in template per task description.","created_at":"2026-02-07T02:37:04Z"},{"id":15,"issue_id":"cap-8ax.2.1","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create worklog template with bead interpolation for pipeline context\nBefore: No worklog template existed; pipeline phases had no shared context document\nAfter: templates/worklog.md.template provides Mission Briefing + Phase Log with 11 placeholders; envsubst-based rendering handles special chars and multi-line values\n\nProblems encountered:\n  - Bash parameter expansion mangles \u0026 in replacements: switched to envsubst\n  - Test E1 caught this correctly in RED phase debugging\n\nIssues filed: 0\nCommit: 30411c8\nPush: success","created_at":"2026-02-07T03:28:38Z"}]}
{"id":"cap-8ax.2.2","title":"Create prep.sh script for worktree + worklog setup","description":"scripts/prep.sh \u003cbead-id\u003e [--project-dir=.]: 1. Validate bead exists (bd show \u003cbead-id\u003e), 2. Extract bead context (title, description, parent chain via bd show), 3. Create worktree: git worktree add -b capsule-\u003cbead-id\u003e .capsule/worktrees/\u003cbead-id\u003e main, 4. Instantiate worklog.md from template with bead context, 5. Place worklog.md in worktree root, 6. Create .capsule/logs/ directory if not exists. Error handling: check git status clean, bead exists, worktree doesn't already exist. Depends on: t-1.2.1. Deliverable: scripts/prep.sh creating worktree with instantiated worklog","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:59.786180405-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T20:36:59.157393627-08:00","closed_at":"2026-02-06T20:36:59.157393627-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.2.2","depends_on_id":"cap-8ax.2","type":"parent-child","created_at":"2026-02-06T08:29:59.787834665-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.2.2","depends_on_id":"cap-8ax.2.1","type":"blocks","created_at":"2026-02-06T08:32:05.040562665-08:00","created_by":"Sam Biggins"}],"comments":[{"id":16,"issue_id":"cap-8ax.2.2","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create prep.sh to set up isolated git worktrees with instantiated worklogs for bead-driven pipeline execution\nBefore: No way to create isolated working environments for capsule pipeline phases\nAfter: scripts/prep.sh creates git worktrees with bead-specific worklogs, enabling isolated phase execution\n\nFiles: 2 changed (scripts/prep.sh, tests/scripts/test-prep-script.sh)\nFindings: none","created_at":"2026-02-07T04:37:06Z"},{"id":17,"issue_id":"cap-8ax.2.2","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved (after fixes)\nIssues: 0 critical, 1 major (fixed), 2 minor (1 fixed, 1 deferred), 2 nits (deferred)\nSummary: Well-structured scripts following codebase patterns. Fixed missing jq/envsubst prerequisite check and added grandparent type validation. All tests pass.","created_at":"2026-02-07T04:40:25Z"},{"id":18,"issue_id":"cap-8ax.2.2","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create prep.sh to set up isolated git worktrees with instantiated worklogs for bead-driven pipeline execution\nBefore: Template and worklog existed but no automation to create isolated working environments from beads\nAfter: scripts/prep.sh creates git worktrees on capsule-\u003cbead-id\u003e branches with bead-specific worklogs containing full epic/feature/task context\n\nProblems encountered:\n  - Taster: jq false dependency in test prereqs: removed\n  - Taster: E2 silently swallowed errors: fixed with output capture\n  - Sous-chef: missing jq/envsubst prereq check: added to loop\n  - Sous-chef: grandparent type not validated: added issue_type guard\n\nIssues filed:\n  - cap-am2: Add worktree cleanup on template instantiation failure [P4]\n\nCommit: fe7359b\nPush: success","created_at":"2026-02-07T04:41:44Z"}]}
{"id":"cap-8ax.3","title":"Test-writer and test-review headless claude prompt pair","description":"As a pipeline orchestrator, I want test-writer and test-review prompts that produce structured results so that I can write quality tests with a feedback loop.","acceptance_criteria":"Given a worktree with worklog, When claude -p runs with test-writer prompt, Then test files are created in the worktree; Given test-writer output, When the last JSON block is parsed, Then it contains {status, feedback, files_changed}; Given created tests, When claude -p runs with test-review prompt, Then it returns PASS or NEEDS_WORK with specific feedback; Given NEEDS_WORK from test-review, When test-writer re-runs with feedback, Then tests improve based on feedback","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:48.700283465-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:48.700283465-08:00","dependencies":[{"issue_id":"cap-8ax.3","depends_on_id":"cap-8ax","type":"parent-child","created_at":"2026-02-06T08:28:48.702494341-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.3.1","title":"Define structured JSON signal contract","description":"Create docs/signal-contract.md defining the JSON output every phase must produce: {status: PASS|NEEDS_WORK|ERROR, feedback: human-readable explanation, files_changed: [path/to/file1.go, ...], summary: one-line description}. Create scripts/parse-signal.sh that extracts the last JSON block from claude output. Tests: parse valid JSON, parse from mixed output, handle missing JSON (return ERROR status). Deliverable: Signal contract doc + parse-signal.sh parser","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:17.650537457-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T21:53:14.081571532-08:00","closed_at":"2026-02-06T21:53:14.081571532-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.3.1","depends_on_id":"cap-8ax.3","type":"parent-child","created_at":"2026-02-06T08:30:17.652182363-08:00","created_by":"Sam Biggins"}],"comments":[{"id":19,"issue_id":"cap-8ax.3.1","author":"Sam Biggins","text":"PHASE: COOK\nStatus: started","created_at":"2026-02-07T05:49:03Z"},{"id":20,"issue_id":"cap-8ax.3.1","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Define the structured JSON signal contract that all pipeline phases must produce, and create the parser that extracts it from mixed output.\nBefore: No shared contract for phase communication; no way to parse structured results from claude output.\nAfter: Signal contract documented (docs/signal-contract.md), parser implemented (scripts/parse-signal.sh) with 11 passing tests covering valid parsing, mixed output, validation, and error cases.\n\nFiles: 3 changed\nFindings: none","created_at":"2026-02-07T05:53:22Z"},{"id":21,"issue_id":"cap-8ax.3.1","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved (after fixes)\nIssues: 0 critical, 2 major (both fixed), 2 minor (deferred), 3 nits (deferred)\nSummary: Well-structured signal contract and parser. Fixed JSON injection in error_signal() by using jq --arg. Replaced fragile brace-counting extraction with bottom-up jq validation approach. All 30 tests pass.","created_at":"2026-02-07T05:57:48Z"},{"id":22,"issue_id":"cap-8ax.3.1","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Define the structured JSON signal contract that all pipeline phases must produce, and create the parser that extracts it from mixed output.\nBefore: No shared contract for phase communication; no way to parse structured results from claude output.\nAfter: Signal contract documented (docs/signal-contract.md), parser implemented (scripts/parse-signal.sh) with bottom-up jq validation. 11 passing tests.\n\nProblems encountered:\n  - Sous-chef: JSON injection in error_signal() via string interpolation: fixed with jq --arg\n  - Sous-chef: Brace-counting extraction fragile with braces in strings: replaced with bottom-up jq validation\n\nIssues filed: 0\nCommit: b32066c\nPush: success","created_at":"2026-02-07T05:58:42Z"}]}
{"id":"cap-8ax.3.2","title":"Create test-writer prompt template","description":"Create prompts/test-writer.md: Instructions to read worklog.md for task context, write failing tests for ALL acceptance criteria, tests must fail for the right reason (not syntax errors), update worklog.md with [TEST-WRITER] entry, output structured JSON signal as final output. Include CLAUDE.md reference, worklog reference, and the signal contract in the prompt. Depends on: t-1.3.1. Deliverable: prompts/test-writer.md","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:17.70629787-08:00","created_by":"Sam Biggins","updated_at":"2026-02-07T04:33:49.582375803-08:00","closed_at":"2026-02-07T04:33:49.582375803-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.3.2","depends_on_id":"cap-8ax.3","type":"parent-child","created_at":"2026-02-06T08:30:17.707938419-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.2","depends_on_id":"cap-8ax.3.1","type":"blocks","created_at":"2026-02-06T08:32:05.099021919-08:00","created_by":"Sam Biggins"}],"comments":[{"id":23,"issue_id":"cap-8ax.3.2","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create the test-writer prompt template that instructs Claude to read worklog context, write failing tests for all acceptance criteria, and output structured JSON signals.\nBefore: No test-writer prompt existed; the pipeline had no way to invoke test creation.\nAfter: prompts/test-writer.md provides complete instructions for headless Claude to write RED-phase tests with signal output.\n\nFiles: 1 changed (prompts/test-writer.md created)\nFindings: none","created_at":"2026-02-07T12:34:05Z"},{"id":24,"issue_id":"cap-8ax.3.2","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved (after minor fixes)\nIssues: 2 minor, 2 nits (all addressed)\nSummary: Prompt template is well-structured, covers all TDD spec test cases and edge cases. Minor alignment fixes applied for signal contract wording and feedback injection documentation.","created_at":"2026-02-07T12:37:38Z"},{"id":25,"issue_id":"cap-8ax.3.2","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create test-writer prompt template for headless Claude pipeline\nBefore: No test-writer prompt; pipeline could not invoke test creation phase\nAfter: prompts/test-writer.md provides complete RED-phase test instructions\n\nProblems encountered:\n  - Database mismatch warning (pre-existing, non-blocking)\n\nIssues filed: 0\nCommit: c184dd7\nPush: success","created_at":"2026-02-07T13:22:20Z"}]}
{"id":"cap-8ax.3.3","title":"Create test-review prompt template","description":"Create prompts/test-review.md: Read worklog.md for context and test-writer entry, verify tests exist for each acceptance criterion, verify tests fail for the right reason, verify test isolation/clarity/naming, return PASS if quality sufficient NEEDS_WORK with specific feedback if not, update worklog.md with [TEST-REVIEW] entry, output structured JSON signal. Depends on: t-1.3.1. Deliverable: prompts/test-review.md","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:17.764530344-08:00","created_by":"Sam Biggins","updated_at":"2026-02-07T05:29:20.984030106-08:00","closed_at":"2026-02-07T05:29:20.984030106-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.3.3","depends_on_id":"cap-8ax.3","type":"parent-child","created_at":"2026-02-06T08:30:17.766082213-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.3","depends_on_id":"cap-8ax.3.1","type":"blocks","created_at":"2026-02-06T08:32:05.156918482-08:00","created_by":"Sam Biggins"}],"comments":[{"id":26,"issue_id":"cap-8ax.3.3","author":"Sam Biggins","text":"PHASE: COOK\nStatus: started","created_at":"2026-02-07T13:28:15Z"},{"id":27,"issue_id":"cap-8ax.3.3","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create the test-review prompt template so the pipeline can validate test quality before moving to implementation\nBefore: Only test-writer prompt existed; no way to review/validate test quality in the pipeline\nAfter: test-review prompt pairs with test-writer, enabling the review feedback loop for the test phase\n\nFiles: 1 changed (prompts/test-review.md created)\nFindings: none","created_at":"2026-02-07T13:29:26Z"},{"id":28,"issue_id":"cap-8ax.3.3","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved\nIssues: 3 nits (none blocking)\nSummary: Well-structured prompt template, consistent with test-writer.md and signal contract. Only nits found (missing feedback placeholder for re-review, no ERROR example, hardcoded Phase 2 numbering).","created_at":"2026-02-07T13:34:45Z"},{"id":29,"issue_id":"cap-8ax.3.3","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create test-review prompt to complete the test phase review loop\nBefore: Only test-writer prompt existed; no validation of test quality\nAfter: test-review prompt pairs with test-writer, enabling PASS/NEEDS_WORK feedback\n\nProblems encountered:\n  - none\n\nIssues filed:\n  - none\n\nCommit: bfe911e\nPush: success","created_at":"2026-02-07T13:37:23Z"}]}
{"id":"cap-8ax.3.4","title":"Create run-phase.sh script for headless claude invocation","description":"scripts/run-phase.sh \u003cphase-name\u003e \u003cworktree-path\u003e [--feedback=...]: 1. Load prompt from prompts/\u003cphase-name\u003e.md, 2. If --feedback provided append feedback section, 3. Invoke: claude -p with --dangerously-skip-permissions in worktree directory, 4. Capture stdout to .capsule/output/\u003cphase-name\u003e-\u003ctimestamp\u003e.log, 5. Parse signal via parse-signal.sh, 6. Print result, 7. Exit code: 0=PASS 1=NEEDS_WORK 2=ERROR. Error handling: timeout, claude not found, worktree not found. Depends on: t-1.3.1. Deliverable: scripts/run-phase.sh for any phase invocation","status":"closed","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:17.831090193-08:00","created_by":"Sam Biggins","updated_at":"2026-02-07T05:55:51.191890512-08:00","closed_at":"2026-02-07T05:55:51.191890512-08:00","close_reason":"Closed","dependencies":[{"issue_id":"cap-8ax.3.4","depends_on_id":"cap-8ax.3","type":"parent-child","created_at":"2026-02-06T08:30:17.832672024-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.4","depends_on_id":"cap-8ax.3.1","type":"blocks","created_at":"2026-02-06T08:32:05.214473776-08:00","created_by":"Sam Biggins"}],"comments":[{"id":30,"issue_id":"cap-8ax.3.4","author":"Sam Biggins","text":"PHASE: COOK\nStatus: completed\n\nSEMANTIC CONTEXT (for tidy summary):\nIntent: Create the run-phase.sh script that loads prompt templates, invokes headless claude, captures output, parses the signal, and returns structured exit codes.\nBefore: No way to invoke a capsule pipeline phase from the command line; prompts existed but had no execution harness.\nAfter: scripts/run-phase.sh provides a generic phase runner: loads prompts/\u003cphase\u003e.md, invokes claude -p in worktree, captures stdout to .capsule/output/\u003cphase\u003e-\u003ctimestamp\u003e.log, parses signal via parse-signal.sh, and returns exit 0/1/2 for PASS/NEEDS_WORK/ERROR. Supports --feedback for retry context.\n\nFiles: 2 changed (scripts/run-phase.sh, tests/scripts/test-run-phase.sh)\nFindings: none","created_at":"2026-02-07T13:56:06Z"},{"id":31,"issue_id":"cap-8ax.3.4","author":"Sam Biggins","text":"PHASE: SERVE\nStatus: completed\nVerdict: approved (after fixes)\nIssues: 0 critical, 3 minor (all fixed), 1 nit (deferred)\nSummary: Well-structured script following existing patterns. Fixed: echo→printf for robustness, added PID to timestamp for uniqueness, separated stderr from stdout in claude invocation, fixed test 7 log cleanup for isolation.","created_at":"2026-02-07T14:00:00Z"},{"id":32,"issue_id":"cap-8ax.3.4","author":"Sam Biggins","text":"PHASE: TIDY\nStatus: completed\n\nSESSION SUMMARY\n━━━━━━━━━━━━━━━\nIntent: Create the run-phase.sh script for invoking capsule pipeline phases via headless claude with structured signal parsing.\nBefore: Prompt templates existed but had no execution harness; no way to invoke a pipeline phase from the command line.\nAfter: scripts/run-phase.sh provides a generic phase runner: loads prompts, invokes claude -p in worktree, captures output to logs, parses signal, returns structured exit codes. Supports --feedback for retry context.\n\nProblems encountered:\n  - Taster: Test 7 log directory path ambiguity: resolved by placing logs at worktree/.capsule/output/\n  - Sous-chef: echo fragile with leading dashes: fixed with printf\n  - Sous-chef: Timestamp collision risk: fixed with PID suffix\n  - Sous-chef: stderr polluting signal parsing: separated stderr to .log.stderr file\n  - Test 7 stale log files from earlier tests: fixed with cleanup before assertion\n\nIssues filed: 0\nCommit: 8e2d7b8\nPush: success","created_at":"2026-02-07T14:01:46Z"}]}
{"id":"cap-8ax.3.5","title":"Validate test-writer/test-review pair end-to-end","description":"Integration test: 1. Run setup-template.sh to create test project, 2. Run prep.sh \u003ctask-id\u003e to create worktree, 3. Run run-phase.sh test-writer \u003cworktree\u003e, 4. Verify test files created worklog updated, 5. Run run-phase.sh test-review \u003cworktree\u003e, 6. Verify structured JSON result, 7. If NEEDS_WORK run test-writer again with feedback. Document exact claude commands used. Depends on: t-1.3.2, t-1.3.3, t-1.3.4, t-1.2.2. Deliverable: tests/test-phase-pair-test-writer.sh integration test","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:17.892312921-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:17.892312921-08:00","dependencies":[{"issue_id":"cap-8ax.3.5","depends_on_id":"cap-8ax.3","type":"parent-child","created_at":"2026-02-06T08:30:17.893893598-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.5","depends_on_id":"cap-8ax.3.2","type":"blocks","created_at":"2026-02-06T08:32:05.27319286-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.5","depends_on_id":"cap-8ax.3.3","type":"blocks","created_at":"2026-02-06T08:32:05.338216192-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.5","depends_on_id":"cap-8ax.3.4","type":"blocks","created_at":"2026-02-06T08:32:05.398804083-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.3.5","depends_on_id":"cap-8ax.2.2","type":"blocks","created_at":"2026-02-06T08:32:05.463733674-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.4","title":"Execute and execute-review headless claude prompt pair","description":"As a pipeline orchestrator, I want execute and execute-review prompts so that the agent implements code that passes the tests created in the previous phase.","acceptance_criteria":"Given a worktree with failing tests, When claude -p runs with execute prompt, Then implementation code is created that passes the tests; Given execute output, When parsed, Then JSON signal contains PASS/NEEDS_WORK/ERROR with files_changed; Given implementation, When claude -p runs with execute-review prompt, Then it verifies tests pass and code quality is acceptable; Given NEEDS_WORK from review, When execute re-runs with feedback, Then implementation improves","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:48.760776967-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:48.760776967-08:00","dependencies":[{"issue_id":"cap-8ax.4","depends_on_id":"cap-8ax","type":"parent-child","created_at":"2026-02-06T08:28:48.762569625-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.4.1","title":"Create execute prompt template","description":"Create prompts/execute.md: Read worklog.md for task context AND test-writer/review entries, run existing tests to confirm RED state, implement minimal code to pass all tests (GREEN), refactor for clarity while tests pass (REFACTOR), update worklog.md with [EXECUTE] entry, output structured JSON signal. Depends on: t-1.3.1. Deliverable: prompts/execute.md","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:25.245550177-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:25.245550177-08:00","dependencies":[{"issue_id":"cap-8ax.4.1","depends_on_id":"cap-8ax.4","type":"parent-child","created_at":"2026-02-06T08:30:25.247504311-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.4.1","depends_on_id":"cap-8ax.3.1","type":"blocks","created_at":"2026-02-06T08:32:05.519735311-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.4.2","title":"Create execute-review prompt template","description":"Create prompts/execute-review.md: Read worklog.md for full context, run tests verify all pass, review code quality (correctness, style, no hacks), verify only acceptance-criteria-scoped changes (no scope creep), update worklog.md with [EXECUTE-REVIEW] entry, return PASS or NEEDS_WORK with feedback. Depends on: t-1.3.1. Deliverable: prompts/execute-review.md","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:25.305732509-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:25.305732509-08:00","dependencies":[{"issue_id":"cap-8ax.4.2","depends_on_id":"cap-8ax.4","type":"parent-child","created_at":"2026-02-06T08:30:25.307553109-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.4.2","depends_on_id":"cap-8ax.3.1","type":"blocks","created_at":"2026-02-06T08:32:05.577559428-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.4.3","title":"Validate execute/execute-review pair end-to-end","description":"Integration test: 1. Start from state after successful test-writer/test-review, 2. Run run-phase.sh execute \u003cworktree\u003e, 3. Verify implementation files created tests now pass, 4. Run run-phase.sh execute-review \u003cworktree\u003e, 5. Verify PASS result. Document exact commands. Depends on: t-1.4.1, t-1.4.2, t-1.3.5. Deliverable: tests/test-phase-pair-execute.sh integration test","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:25.363874002-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:25.363874002-08:00","dependencies":[{"issue_id":"cap-8ax.4.3","depends_on_id":"cap-8ax.4","type":"parent-child","created_at":"2026-02-06T08:30:25.365500834-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.4.3","depends_on_id":"cap-8ax.4.1","type":"blocks","created_at":"2026-02-06T08:32:05.638842378-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.4.3","depends_on_id":"cap-8ax.4.2","type":"blocks","created_at":"2026-02-06T08:32:05.697832002-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.4.3","depends_on_id":"cap-8ax.3.5","type":"blocks","created_at":"2026-02-06T08:32:05.755999583-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.5","title":"Sign-off and merge-to-main headless claude prompt pair","description":"As a pipeline orchestrator, I want sign-off and merge prompts so that only relevant implementation files are merged to main and worklogs are archived to .capsule/logs/.","acceptance_criteria":"Given a worktree with passing tests, When claude -p runs with sign-off prompt, Then it validates quality and returns PASS or NEEDS_WORK; Given PASS from sign-off, When merge.sh runs, Then only implementation/test files are on main (no worklog.md); Given successful merge, When ls .capsule/logs/\u003cbead-id\u003e/ runs, Then worklog.md is archived there; Given successful merge, When git worktree list runs, Then the mission worktree is removed; Given successful merge, When bd show \u003cbead-id\u003e runs, Then the bead status is closed","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:48.819604628-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:48.819604628-08:00","dependencies":[{"issue_id":"cap-8ax.5","depends_on_id":"cap-8ax","type":"parent-child","created_at":"2026-02-06T08:28:48.82122899-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.5.1","title":"Create sign-off prompt template","description":"Create prompts/sign-off.md: Read worklog.md for full mission context, run tests verify all pass, verify commit-ready state (no temp files, no debug code), verify acceptance criteria met, update worklog.md with [SIGN-OFF] entry, return PASS or NEEDS_WORK. Depends on: t-1.3.1. Deliverable: prompts/sign-off.md","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:33.853923637-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:33.853923637-08:00","dependencies":[{"issue_id":"cap-8ax.5.1","depends_on_id":"cap-8ax.5","type":"parent-child","created_at":"2026-02-06T08:30:33.855715068-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.5.1","depends_on_id":"cap-8ax.3.1","type":"blocks","created_at":"2026-02-06T08:32:05.812790359-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.5.2","title":"Create merge.sh script for selective merge and archival","description":"scripts/merge.sh \u003cbead-id\u003e [--project-dir=.]: 1. cd to worktree verify sign-off PASS, 2. Stage only implementation+test files (explicit git add NOT git add -A), 3. Commit with bead-id: task-title, 4. Switch to main, 5. Merge with --no-ff, 6. Archive worklog to .capsule/logs/\u003cbead-id\u003e/, 7. Archive phase outputs, 8. Remove worktree, 9. Delete branch, 10. Close bead. Error handling: merge conflicts, missing worktree, already merged. Deliverable: scripts/merge.sh with selective merge and archival","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:33.914983023-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:33.914983023-08:00","dependencies":[{"issue_id":"cap-8ax.5.2","depends_on_id":"cap-8ax.5","type":"parent-child","created_at":"2026-02-06T08:30:33.916949044-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.5.3","title":"Validate sign-off/merge pair end-to-end","description":"Integration test: 1. Start from state after successful execute/execute-review, 2. Run run-phase.sh sign-off \u003cworktree\u003e, 3. Verify PASS result, 4. Run merge.sh \u003cbead-id\u003e, 5. Verify: files on main, worklog in .capsule/logs/, worktree gone, bead closed. Depends on: t-1.5.1, t-1.5.2, t-1.4.3. Deliverable: tests/test-phase-pair-merge.sh integration test","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:33.985517714-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:33.985517714-08:00","dependencies":[{"issue_id":"cap-8ax.5.3","depends_on_id":"cap-8ax.5","type":"parent-child","created_at":"2026-02-06T08:30:33.9872202-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.5.3","depends_on_id":"cap-8ax.5.1","type":"blocks","created_at":"2026-02-06T08:32:05.872513033-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.5.3","depends_on_id":"cap-8ax.5.2","type":"blocks","created_at":"2026-02-06T08:32:05.930716882-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.5.3","depends_on_id":"cap-8ax.4.3","type":"blocks","created_at":"2026-02-06T08:32:06.009127176-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.6","title":"Full pipeline orchestration script and command documentation","description":"As a capsule developer, I want a single script that runs the full pipeline and documentation of every command used so that Epic 2 has a clear specification to implement.","acceptance_criteria":"Given a template project, When run-pipeline.sh \u003cbead-id\u003e runs, Then the full pipeline executes (prep → test-write → test-review → execute → execute-review → sign-off → merge); Given the pipeline, When a reviewer phase returns NEEDS_WORK, Then the worker phase retries with feedback (up to configured max); Given the pipeline completes, When reviewing .capsule/logs/\u003cbead-id\u003e/, Then the full worklog with all phase entries is archived; Given docs/commands.md, When reading it, Then every claude command, script invocation, and expected output is documented","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:48.877165132-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:48.877165132-08:00","dependencies":[{"issue_id":"cap-8ax.6","depends_on_id":"cap-8ax","type":"parent-child","created_at":"2026-02-06T08:28:48.878703688-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.6.1","title":"Create run-pipeline.sh orchestration script","description":"scripts/run-pipeline.sh \u003cbead-id\u003e [--project-dir=.] [--max-retries=2]: 1. Run prep.sh \u003cbead-id\u003e, 2. Phase pair loop: test-writer → test-review (max 3 retries), 3. Phase pair loop: execute → execute-review (max 2 retries), 4. Run sign-off (max 2 retries, retries execute on NEEDS_WORK), 5. Run merge.sh \u003cbead-id\u003e, 6. Print summary. Error handling: any ERROR aborts, preserves worktree. Depends on: t-1.3.4, t-1.5.2. Deliverable: scripts/run-pipeline.sh full orchestration","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:45.96429143-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:45.96429143-08:00","dependencies":[{"issue_id":"cap-8ax.6.1","depends_on_id":"cap-8ax.6","type":"parent-child","created_at":"2026-02-06T08:30:45.96627694-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.6.1","depends_on_id":"cap-8ax.3.4","type":"blocks","created_at":"2026-02-06T08:32:06.068811302-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.6.1","depends_on_id":"cap-8ax.5.2","type":"blocks","created_at":"2026-02-06T08:32:06.127712573-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.6.2","title":"Create teardown.sh cleanup script","description":"scripts/teardown.sh [--project-dir=.]: Remove all capsule worktrees, clean .capsule/output/ (but preserve .capsule/logs/), prune git worktree metadata, report what was cleaned. Error handling: graceful if nothing to clean. Deliverable: scripts/teardown.sh for environment cleanup","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:46.024348479-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:46.024348479-08:00","dependencies":[{"issue_id":"cap-8ax.6.2","depends_on_id":"cap-8ax.6","type":"parent-child","created_at":"2026-02-06T08:30:46.025957032-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.6.3","title":"Document all commands and create specification for Epic 2","description":"Create docs/commands.md documenting: every script with usage args exit codes, every claude -p invocation with exact flags, the signal contract with examples, the retry logic rules, the worklog lifecycle, the worktree lifecycle, directory structure (.capsule/ prompts/ scripts/ templates/). This becomes the specification for Epic 2 Go implementation. Depends on: t-1.6.1. Deliverable: docs/commands.md — specification for Epic 2","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:46.083575855-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:46.083575855-08:00","dependencies":[{"issue_id":"cap-8ax.6.3","depends_on_id":"cap-8ax.6","type":"parent-child","created_at":"2026-02-06T08:30:46.085314785-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.6.3","depends_on_id":"cap-8ax.6.1","type":"blocks","created_at":"2026-02-06T08:32:06.185892119-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-8ax.6.4","title":"Full pipeline E2E smoke test","description":"tests/test-full-pipeline.sh: 1. Run setup-template.sh, 2. Run run-pipeline.sh \u003ctask-bead-id\u003e, 3. Assert: tests exist on main, 4. Assert: implementation passes tests, 5. Assert: worklog in .capsule/logs/\u003cbead-id\u003e/, 6. Assert: no worktree remains, 7. Assert: bead is closed, 8. Cleanup with teardown.sh. This is the Epic 1 E2E smoke test. Depends on: t-1.6.1. Deliverable: tests/test-full-pipeline.sh E2E smoke test","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:46.146759408-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:46.146759408-08:00","dependencies":[{"issue_id":"cap-8ax.6.4","depends_on_id":"cap-8ax.6","type":"parent-child","created_at":"2026-02-06T08:30:46.148477326-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-8ax.6.4","depends_on_id":"cap-8ax.6.1","type":"blocks","created_at":"2026-02-06T08:32:06.246706677-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv","title":"Go CLI Tool","description":"Transform Epic 1's validated scripts into a Go CLI using Kong. Provider interface wraps claude subprocess. Orchestrator sequences phase pairs. Plain text status output. All behavior matches Epic 1's proven workflow.","acceptance_criteria":"capsule run produces same outcome as run-pipeline.sh; Handles NEEDS_WORK retries; Exits cleanly on ERROR; capsule abort cleans up; capsule version prints info","status":"open","priority":0,"issue_type":"epic","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:02.986099934-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:02.986099934-08:00","dependencies":[{"issue_id":"cap-9qv","depends_on_id":"cap-8ax","type":"blocks","created_at":"2026-02-06T08:28:17.396886897-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.1","title":"Go project skeleton with Kong CLI and test harness","description":"As a developer, I want a Go project with Kong CLI, Makefile, and test harness so that I have a solid foundation for the capsule CLI tool.","acceptance_criteria":"Given the project, When go build ./... runs, Then a capsule binary is produced; Given the binary, When capsule version runs, Then version/commit/date is printed; Given the binary, When capsule run without args runs, Then usage is printed and exit code is non-zero; Given the Makefile, When make test runs, Then all tests pass","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:11.234402687-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:11.234402687-08:00","dependencies":[{"issue_id":"cap-9qv.1","depends_on_id":"cap-9qv","type":"parent-child","created_at":"2026-02-06T08:29:11.236047089-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.1.1","title":"Initialize Go module and directory structure","description":"go.mod, directory tree: cmd/capsule/main.go, internal/{provider,orchestrator,config,worktree,worklog,tui,prompt}/. Placeholder test in each package. go mod tidy. Deliverable: go build ./... and go test ./... pass","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:57.197319265-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:57.197319265-08:00","dependencies":[{"issue_id":"cap-9qv.1.1","depends_on_id":"cap-9qv.1","type":"parent-child","created_at":"2026-02-06T08:30:57.199112277-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.1.2","title":"Set up Kong CLI with version and run commands","description":"Kong CLI struct with Version, Run, Abort, Clean commands. Version prints ldflags version info. Run takes bead-id arg + --provider, --timeout, --debug flags. Abort takes bead-id + --force. Depends on: t-2.1.1. Deliverable: Kong CLI with all command stubs","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:57.258427187-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:57.258427187-08:00","dependencies":[{"issue_id":"cap-9qv.1.2","depends_on_id":"cap-9qv.1","type":"parent-child","created_at":"2026-02-06T08:30:57.260009247-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.1.2","depends_on_id":"cap-9qv.1.1","type":"blocks","created_at":"2026-02-06T08:32:09.483759417-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.1.3","title":"Create Makefile and CLAUDE.md","description":"build/test/lint/clean targets. CLAUDE.md with project conventions. tdd: false. Depends on: t-2.1.1. Deliverable: Makefile + CLAUDE.md","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:30:57.317390045-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:30:57.317390045-08:00","dependencies":[{"issue_id":"cap-9qv.1.3","depends_on_id":"cap-9qv.1","type":"parent-child","created_at":"2026-02-06T08:30:57.319203882-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.1.3","depends_on_id":"cap-9qv.1.1","type":"blocks","created_at":"2026-02-06T08:32:09.541903268-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.2","title":"Provider interface wrapping headless claude subprocess","description":"As an orchestrator, I want a Provider interface with Execute() so that I can call AI agents as subprocess calls with structured output parsing.","acceptance_criteria":"Given a Provider, When Execute(ctx, prompt, workDir) is called, Then it returns Result{Output, ExitCode, Duration, Signal}; Given ClaudeProvider, When Execute runs, Then it invokes claude -p with correct flags in workDir; Given a timeout context, When the subprocess exceeds it, Then the process is killed and a TimeoutError is returned; Given claude output with JSON signal, When Result is returned, Then Signal field contains parsed PhaseResult","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:11.291760858-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:11.291760858-08:00","dependencies":[{"issue_id":"cap-9qv.2","depends_on_id":"cap-9qv","type":"parent-child","created_at":"2026-02-06T08:29:11.293416506-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.2.1","title":"Define Provider interface, Result, and Signal types","description":"internal/provider/provider.go: Provider interface with Name() and Execute(ctx, prompt, workDir). Result{Output, ExitCode, Duration, Signal}. Signal = parsed PhaseResult{Status, Feedback, FilesChanged, Summary}. MockProvider for testing. SignalParser extracts JSON from output. Error types: TimeoutError, ProviderError, SignalParseError. Tests: mock execute, signal parsing (valid, missing, malformed), error type matching with errors.Is. Deliverable: Provider interface with signal parsing and error types","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:07.612763565-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:07.612763565-08:00","dependencies":[{"issue_id":"cap-9qv.2.1","depends_on_id":"cap-9qv.2","type":"parent-child","created_at":"2026-02-06T08:31:07.614403576-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.2.2","title":"Implement ClaudeProvider with subprocess execution","description":"internal/provider/claude.go: Calls claude -p \u003cprompt\u003e --dangerously-skip-permissions in workDir. Uses exec.CommandContext for timeout. Captures stdout+stderr. Parses signal from output. Re-exec pattern for unit tests. Error handling: process kill on timeout, non-zero exit without signal → ProviderError with stderr content. Depends on: t-2.2.1. Deliverable: ClaudeProvider with re-exec tests","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:07.671600368-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:07.671600368-08:00","dependencies":[{"issue_id":"cap-9qv.2.2","depends_on_id":"cap-9qv.2","type":"parent-child","created_at":"2026-02-06T08:31:07.673182044-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.2.2","depends_on_id":"cap-9qv.2.1","type":"blocks","created_at":"2026-02-06T08:32:09.602020573-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.2.3","title":"Add provider registry with factory pattern","description":"internal/provider/registry.go: Register(name, factory), NewProvider(name), AvailableProviders(). Error handling: unknown provider returns clear error. Depends on: t-2.2.1. Deliverable: Provider registry","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:07.728236668-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:07.728236668-08:00","dependencies":[{"issue_id":"cap-9qv.2.3","depends_on_id":"cap-9qv.2","type":"parent-child","created_at":"2026-02-06T08:31:07.729823288-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.2.3","depends_on_id":"cap-9qv.2.1","type":"blocks","created_at":"2026-02-06T08:32:09.662280311-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.3","title":"Configuration loading and external prompt management","description":"As a user, I want capsule to load config from YAML and prompts from external files so that I can customize behavior per-project.","acceptance_criteria":"Given a config.yaml, When capsule loads config, Then Runtime.Provider, Runtime.Timeout, and Worktree.BaseDir are set; Given no config file, When capsule loads config, Then sensible defaults are used; Given prompts/ directory, When prompt loader loads test-writer, Then prompts/test-writer.md content is returned; Given prompt context, When Compose is called, Then bead info and feedback are interpolated into the prompt","status":"open","priority":1,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:11.350132002-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:11.350132002-08:00","dependencies":[{"issue_id":"cap-9qv.3","depends_on_id":"cap-9qv","type":"parent-child","created_at":"2026-02-06T08:29:11.351750672-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.3.1","title":"Implement Config struct and layered loading","description":"internal/config/config.go: Config{Runtime{Provider, Timeout}, Worktree{BaseDir}}. Load(path), DefaultConfig(), env var overrides. Priority: defaults \u003c user (~/.config/capsule/) \u003c project (.capsule/) \u003c env. Error handling: missing file = use defaults, invalid YAML = error. Deliverable: Config loading with layered priority","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:12.62700604-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:12.62700604-08:00","dependencies":[{"issue_id":"cap-9qv.3.1","depends_on_id":"cap-9qv.3","type":"parent-child","created_at":"2026-02-06T08:31:12.628695812-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.3.2","title":"Implement prompt Loader and Composer","description":"internal/prompt/loader.go: Loader{promptsDir}. Load(phaseName) reads prompts/\u003cname\u003e.md. Compose(phaseName, Context{BeadID, Title, Description, Feedback}) interpolates context into loaded template. Error handling: missing prompt file, empty prompt, template error. Deliverable: Prompt loader with compose","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:12.684712157-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:12.684712157-08:00","dependencies":[{"issue_id":"cap-9qv.3.2","depends_on_id":"cap-9qv.3","type":"parent-child","created_at":"2026-02-06T08:31:12.686368701-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.4","title":"Worktree creation/cleanup and worklog lifecycle","description":"As an orchestrator, I want worktree and worklog management so that each mission runs in isolation with full context tracking.","acceptance_criteria":"Given a bead ID, When worktree.Create runs, Then .capsule/worktrees/\u003cid\u003e/ exists on branch capsule-\u003cid\u003e; Given a bead context, When worklog.Create runs, Then worklog.md in worktree has mission briefing; Given a completed mission, When worklog.Archive runs, Then worklog is in .capsule/logs/\u003cid\u003e/; Given a worktree, When worktree.Remove runs, Then worktree and branch are cleaned up","status":"open","priority":1,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:11.41069531-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:11.41069531-08:00","dependencies":[{"issue_id":"cap-9qv.4","depends_on_id":"cap-9qv","type":"parent-child","created_at":"2026-02-06T08:29:11.412510644-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.4.1","title":"Implement worktree Manager (create/remove/list/exists)","description":"internal/worktree/manager.go — port from legacy, simplified. Create(id, baseBranch), Remove(id, deleteBranch), List(), Exists(id). Error handling: already exists, git errors, orphaned worktrees. Tests: real git init in t.TempDir. Deliverable: Worktree manager with git tests","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:18.836447838-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:18.836447838-08:00","dependencies":[{"issue_id":"cap-9qv.4.1","depends_on_id":"cap-9qv.4","type":"parent-child","created_at":"2026-02-06T08:31:18.838256182-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.4.2","title":"Implement worklog Creator and Archiver","description":"internal/worklog/worklog.go: Create(worktreePath, BeadContext) — instantiate template. AppendPhaseEntry(worktreePath, PhaseEntry) — add phase result. Archive(worktreePath, archiveDir, beadID) — move to .capsule/logs/. Error handling: missing template, write errors, archive dir creation. Deliverable: Worklog create/append/archive","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:18.898411171-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:18.898411171-08:00","dependencies":[{"issue_id":"cap-9qv.4.2","depends_on_id":"cap-9qv.4","type":"parent-child","created_at":"2026-02-06T08:31:18.979727195-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.5","title":"Orchestrator sequencing phase pairs with retry logic","description":"As a user running capsule run \u003cbead-id\u003e, I want the orchestrator to execute all phase pairs with retries and status output so that I see deterministic progress through the pipeline.","acceptance_criteria":"Given a bead ID, When RunPipeline executes, Then phases run in order: test-writer→test-review→execute→execute-review→sign-off→merge; Given NEEDS_WORK from a reviewer, When retry logic runs, Then the worker phase re-runs with feedback (up to configured max); Given ERROR from any phase, When pipeline detects it, Then pipeline aborts with diagnostic error; Given each phase transition, When StatusCallback fires, Then it includes phase, status, attempt, maxRetry; Given successful pipeline, When complete, Then worktree merged and worklog archived","status":"open","priority":0,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:11.479853854-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:11.479853854-08:00","dependencies":[{"issue_id":"cap-9qv.5","depends_on_id":"cap-9qv","type":"parent-child","created_at":"2026-02-06T08:29:11.481476084-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.5.1","title":"Define phase registry and StatusUpdate types","description":"internal/orchestrator/phases.go: PhaseKind{Worker, Reviewer}, PhaseDefinition{Name, Kind, MaxRetries, RetryTarget}. StatusUpdate{BeadID, Phase, Status, Progress, Attempt, MaxRetry}. StatusCallback func. Register all 6 phases. Deliverable: Phase registry and status types","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:30.433049328-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:30.433049328-08:00","dependencies":[{"issue_id":"cap-9qv.5.1","depends_on_id":"cap-9qv.5","type":"parent-child","created_at":"2026-02-06T08:31:30.438066248-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.5.2","title":"Implement Orchestrator with runPhasePair loop","description":"internal/orchestrator/orchestrator.go: Orchestrator struct with provider, promptLoader, worktreeMgr, worklogMgr, config, statusCallback. Functional options. runPhasePair(ctx, worker, reviewer, feedback) — generic loop. RunPipeline(ctx, beadID) — sequences all phase pairs. Handles: worktree creation, worklog creation, phase execution, retry logic, merge, archive. Abort on ERROR. Error handling: structured PipelineError with phase context. Depends on: t-2.5.1, t-2.2.1, t-2.3.2, t-2.4.1, t-2.4.2. Deliverable: Orchestrator with full pipeline and tests","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:30.505770343-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:30.505770343-08:00","dependencies":[{"issue_id":"cap-9qv.5.2","depends_on_id":"cap-9qv.5","type":"parent-child","created_at":"2026-02-06T08:31:30.50738879-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.2","depends_on_id":"cap-9qv.5.1","type":"blocks","created_at":"2026-02-06T08:32:09.721935804-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.2","depends_on_id":"cap-9qv.2.1","type":"blocks","created_at":"2026-02-06T08:32:09.78699985-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.2","depends_on_id":"cap-9qv.3.2","type":"blocks","created_at":"2026-02-06T08:32:09.845570718-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.2","depends_on_id":"cap-9qv.4.1","type":"blocks","created_at":"2026-02-06T08:32:09.905856007-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.2","depends_on_id":"cap-9qv.4.2","type":"blocks","created_at":"2026-02-06T08:32:09.971248304-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-9qv.5.3","title":"Wire orchestrator into CLI run command with status output","description":"Wire RunCmd → config → provider → orchestrator → StatusCallback. Plain text StatusCallback prints timestamped phase lines. Exit codes: 0=success, 1=pipeline failure, 2=setup error. Add abort and clean commands. Error handling: config errors, provider errors, graceful Ctrl+C. Depends on: t-2.5.2, t-2.1.2, t-2.3.1. Deliverable: CLI fully wired to orchestrator with status output","status":"open","priority":0,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:30.564018691-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:30.564018691-08:00","dependencies":[{"issue_id":"cap-9qv.5.3","depends_on_id":"cap-9qv.5","type":"parent-child","created_at":"2026-02-06T08:31:30.56566248-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.3","depends_on_id":"cap-9qv.5.2","type":"blocks","created_at":"2026-02-06T08:32:10.030813334-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.3","depends_on_id":"cap-9qv.1.2","type":"blocks","created_at":"2026-02-06T08:32:10.095308416-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-9qv.5.3","depends_on_id":"cap-9qv.3.1","type":"blocks","created_at":"2026-02-06T08:32:10.156733351-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-am2","title":"Add worktree cleanup on template instantiation failure in prep.sh","description":"Discovery Source: cap-8ax.2.2 - Create prep.sh script for worktree + worklog setup\nDiscovered During: serve phase\n\nImpact:\nIf worktree creation succeeds but template instantiation fails (e.g., envsubst error, disk full), a partially-created worktree is left behind. Subsequent retry hits \"Worktree already exists\" error requiring manual cleanup.\n\nContext:\nscripts/prep.sh lines 131-162. Could add a trap on ERR after worktree creation to auto-remove on failure. Low priority since all prerequisites are validated upfront.","status":"open","priority":4,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T20:40:45.597263215-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T20:40:45.597263215-08:00"}
{"id":"cap-awd","title":"TUI (Bubble Tea)","description":"Add Bubble Tea TUI for live phase status display. Dual-mode: TUI when TTY detected, plain text when piped. Progressive enhancement from Epic 2's plain text output.","acceptance_criteria":"TTY shows spinner+phase progress; Piped output is plain text; --no-tui forces plain; Ctrl+C cleanly exits; Completion shows summary","status":"open","priority":1,"issue_type":"epic","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:28:05.680274457-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:28:05.680274457-08:00","dependencies":[{"issue_id":"cap-awd","depends_on_id":"cap-9qv","type":"blocks","created_at":"2026-02-06T08:28:17.457645403-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.1","title":"Bubble Tea model for phase pipeline status display","description":"As a user watching a pipeline run, I want a live TUI showing which phase is active, retry counts, and elapsed time so that I can monitor progress at a glance.","acceptance_criteria":"Given a running pipeline, When the TUI renders, Then I see all phases listed with current status (pending/running/pass/fail); Given an active phase, When the TUI renders, Then a spinner animates next to the active phase name; Given a retry, When the TUI updates, Then the attempt counter shows (2/3); Given pipeline completion, When the TUI renders, Then a summary line shows total duration and result","status":"open","priority":1,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:24.645539762-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:24.645539762-08:00","dependencies":[{"issue_id":"cap-awd.1","depends_on_id":"cap-awd","type":"parent-child","created_at":"2026-02-06T08:29:24.647292636-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.1.1","title":"Implement Bubble Tea Model with phase state tracking","description":"internal/tui/model.go: Model{phases []PhaseState, spinner, currentIdx, done, err, startTime}. PhaseState{Name, Status, Attempt, MaxRetry, Duration}. Init() starts spinner. Update() handles StatusUpdateMsg, spinner.TickMsg, tea.KeyMsg (q to quit). View() renders phase list with status indicators. Tests: teatest for Update/View as pure functions. Deliverable: Bubble Tea model with phase tracking","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:51.997375859-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:51.997375859-08:00","dependencies":[{"issue_id":"cap-awd.1.1","depends_on_id":"cap-awd.1","type":"parent-child","created_at":"2026-02-06T08:31:51.999028504-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.1.2","title":"Implement View rendering with lipgloss styling","description":"Render phases with symbols: checkmark (pass), x (fail), hourglass (running+spinner), dot (pending). Retry counter: (2/3). Duration per phase. Summary footer. Lipgloss styles: green=pass, red=fail, yellow=running, dim=pending. Error handling: terminal width detection, graceful fallback. Depends on: t-3.1.1. Deliverable: Styled phase display view","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:52.059249414-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:52.059249414-08:00","dependencies":[{"issue_id":"cap-awd.1.2","depends_on_id":"cap-awd.1","type":"parent-child","created_at":"2026-02-06T08:31:52.060947694-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-awd.1.2","depends_on_id":"cap-awd.1.1","type":"blocks","created_at":"2026-02-06T08:32:11.041286744-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.2","title":"Automatic TTY detection with TUI/plain text switching","description":"As a user, I want capsule to automatically use the TUI in a terminal and plain text when piped so that it works in both interactive and CI contexts.","acceptance_criteria":"Given stdout is a TTY, When capsule run executes, Then Bubble Tea TUI is shown; Given stdout is piped, When capsule run executes, Then plain text lines are printed; Given --no-tui flag, When capsule run in TTY executes, Then plain text is forced; Given StatusCallback, When Display interface receives updates, Then correct renderer handles them","status":"open","priority":1,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:24.702196388-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:24.702196388-08:00","dependencies":[{"issue_id":"cap-awd.2","depends_on_id":"cap-awd","type":"parent-child","created_at":"2026-02-06T08:29:24.70391941-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.2.1","title":"Implement Display interface and TTY detection","description":"internal/tui/display.go: Display interface with Run(ctx, statusChan) error. isTTY() detection. NewDisplay(opts) returns TUI or Plain. Bridge: StatusCallback → channel → Display. Error handling: TUI init failure falls back to plain. Deliverable: Display interface with TTY switching","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:52.117965495-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:52.117965495-08:00","dependencies":[{"issue_id":"cap-awd.2.1","depends_on_id":"cap-awd.2","type":"parent-child","created_at":"2026-02-06T08:31:52.119633864-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.2.2","title":"Wire Display into CLI replacing plain text callback","description":"Update RunCmd to use Display instead of direct StatusCallback. Add --no-tui flag to force plain mode. Orchestrator sends StatusUpdate to channel, Display consumes. Error handling: TUI crash recovery (switch to plain mid-run). Depends on: t-3.2.1, t-3.1.1. Deliverable: CLI with dual-mode display","status":"open","priority":1,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:52.175078038-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:52.175078038-08:00","dependencies":[{"issue_id":"cap-awd.2.2","depends_on_id":"cap-awd.2","type":"parent-child","created_at":"2026-02-06T08:31:52.177306265-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-awd.2.2","depends_on_id":"cap-awd.2.1","type":"blocks","created_at":"2026-02-06T08:32:11.098667792-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-awd.2.2","depends_on_id":"cap-awd.1.1","type":"blocks","created_at":"2026-02-06T08:32:11.222900627-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.3","title":"TUI keyboard controls for abort and status","description":"As a user watching a pipeline, I want keyboard shortcuts to abort the pipeline or view detailed status so that I have control during execution.","acceptance_criteria":"Given a running pipeline in TUI, When I press q or Ctrl+C, Then the pipeline aborts gracefully with cleanup; Given a running pipeline in TUI, When I press d, Then I see detailed status (current phase output, worklog tail); Given an abort, When cleanup completes, Then TUI shows abort summary before exiting","status":"open","priority":2,"issue_type":"feature","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:29:24.762433344-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:29:24.762433344-08:00","dependencies":[{"issue_id":"cap-awd.3","depends_on_id":"cap-awd","type":"parent-child","created_at":"2026-02-06T08:29:24.764131421-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.3.1","title":"Implement abort via keyboard with graceful cleanup","description":"Handle q and Ctrl+C in Update(). Send cancel to orchestrator context. Show Aborting... status, then summary on complete. Error handling: double-press forces immediate exit. Deliverable: Keyboard abort with cleanup","status":"open","priority":2,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:52.23255267-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:52.23255267-08:00","dependencies":[{"issue_id":"cap-awd.3.1","depends_on_id":"cap-awd.3","type":"parent-child","created_at":"2026-02-06T08:31:52.234165548-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-awd.3.2","title":"Implement detail view toggle","description":"d key toggles detail panel showing recent phase output (last N lines from provider stdout) and worklog tail. Uses bubbles/viewport for scrollable content. Depends on: t-3.3.1. Deliverable: Detail view toggle","status":"open","priority":3,"issue_type":"task","owner":"sambiggins@gmail.com","created_at":"2026-02-06T08:31:52.293951232-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T08:31:52.293951232-08:00","dependencies":[{"issue_id":"cap-awd.3.2","depends_on_id":"cap-awd.3","type":"parent-child","created_at":"2026-02-06T08:31:52.295821799-08:00","created_by":"Sam Biggins"},{"issue_id":"cap-awd.3.2","depends_on_id":"cap-awd.3.1","type":"blocks","created_at":"2026-02-06T08:32:11.308599292-08:00","created_by":"Sam Biggins"}]}
{"id":"cap-lbj","title":"Fix hardcoded /tmp/ reference in test-fixtures.sh","description":"Discovery Source: cap-8ax.1.3 - Create setup-template.sh initialization script\nDiscovered During: cook phase (running sibling tests)\n\nImpact:\nEdge case E4 in test-template-source-files.sh fails because test-fixtures.sh\ncontains a /tmp/ reference (mktemp -d usage). Low impact — cosmetic test failure\nin an edge case check, not a functional issue.\n\nContext:\ntemplates/demo-capsule/test-fixtures.sh line 105-106 uses mktemp which references /tmp/.\ntests/scripts/test-template-source-files.sh E4 check greps for absolute paths in template files.","status":"open","priority":4,"issue_type":"bug","owner":"sambiggins@gmail.com","created_at":"2026-02-06T18:17:55.557495603-08:00","created_by":"Sam Biggins","updated_at":"2026-02-06T18:17:55.557495603-08:00"}
